---
title: ソースコード生成ツール
date: 2011-10-15 22:23:02
tags: 未分類, 
---
<ol>
	<li>ソースコードをコピペしてリネームしてちょっと直して、ってすることが多い。</li>
	<li>んじゃあ、うまいことライブラリ化できないかあれこれ試す。</li>
	<li>なんかわかりにくいI/Fになった。</li>
	<li>んじゃあ、よく「リネームして」とか「ちょっと直して」って部分をパラメータ化して設定ファイルで指定して、ソースコードを自動生成するツールを作ってみよう。</li>
	<li>ぼちぼち動くものができた</li>
	<li>その自動生成ツールのソースコードが読みにくい……。←いまここ</li>
</ol>

なんと言うか、自分で書いてて読みにくくてイライラする……。

eRuby使ってCソース文字列の中にeRubyコマンドを埋め込んでるんだけど、eRubyコマンドの条件分岐のブロックのインデントとCソースのブロックのインデントがごちゃごちゃになるんだよねえ……。

eRubyコマンドのブロックを減らすためにメソッドを細かく分けたりすると、Cのアウトプットの一関数を細かく分けざるを得ないため、ローカル変数の宣言の位置と参照の位置がバラバラになるし……。

アウトプットのCソースのインデントを無視すると、今度はその内容のチェックに困るし……。

まあeRubyがどうのって話では無いんだけどね。多分epyとかでも変わらないだろうし。他にうまい手法は思いつかないし。

検索しても、HTMLとかに使うケースの話ばっかり出てきて、Cとか出してるサンプルとかコツとか見当たらないし……。