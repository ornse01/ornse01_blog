---
title: Base64の実装
date: 2011-09-11 21:29:55+09:00
tags: 未分類, 
---
Base64を実装中。
<ul>
	<li>XML-RPCで使うし</li>
	<li>bchanでMHTでも使おうかと考えてるし</li>
	<li>いい感じのライブラリが落ちてなかったし</li>
</ul>

オープンソースでいい感じのがあれば、と思ったけど特に見当たらなかったし。いや、自作のソース貼ってる人とか見かけたし、実はXML-RPCのオープンソースライブラリの中に入ってたりするけどね。

しかし、ライセンスとか面倒だなあと思ったので自作。

作ってみると、大げさに「Base64のオープンソースプロジェクトだ」って立ち上げる程のコードにはならないね。とりあえず<a href="http://tools.ietf.org/html/rfc3548" target="_blank">rfc3548</a>のライブラリってことでBase16とBase32も入れとくとか？　何に使うのか良くわかってないし、当面使い道も無いからやらないけど。

それはさておき、ちょっと気になったのが、改行の扱い。<a href="http://tools.ietf.org/html/rfc3548#section-2.1" target="_blank">rfc3548の2.2</a>を読むと、改行はこの仕様では入れないことになっているんだよね。これを使う側で、適宜入れろ、みたいな？　MIMEの仕様にある、一行あたりの文字数の目安とかで改行するのは、この仕様の範疇ではない、と。

つまり、Base64のライブラリを、「rfc3548のライブラリ」とするなら、改行は入れないコードにするのが正しいことになる。しかし、利便性を考えたら、改行も入れられるようにしたほうが便利かなあ？　と。

まあ、なんと言うか、テストのためにRubyでBase64エンコード済みの文字列を出力させたら改行が入っていたのでどうしよう、と、そんだけの話だったりするんですけど。

そこそこ大きめのデータにしたから、改行取ると、テストコード上にすごい長い文字列が一行になっちゃうし。

細かくテストケースを作るのが面倒だったから、大きめのデータが完全に一致してればいいんじゃね？　みたいな安易な考えでテストケース作ったしなあ……。
